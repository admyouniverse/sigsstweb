(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{164:function(t,e,o){"use strict";function a(t,e,o,a,s,n,i,r){var c,l="function"==typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=o,l._compiled=!0),a&&(l.functional=!0),n&&(l._scopeId="data-v-"+n),i?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},l._ssrRegister=c):s&&(c=r?function(){s.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:s),c)if(l.functional){l._injectStyles=c;var v=l.render;l.render=function(t,e){return c.call(e),v(t,e)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:t,options:l}}o.d(e,"a",(function(){return a}))},196:function(t,e,o){var a=o(297);"string"==typeof a&&(a=[[t.i,a,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};o(132)(a,s);a.locals&&(t.exports=a.locals)},296:function(t,e,o){"use strict";o(196)},297:function(t,e,o){(t.exports=o(131)(!1)).push([t.i,"th {\n  font-weight: 400;\n  cursor: pointer;\n}\nth.selecionado {\n  font-weight: 800;\n}",""])},54:function(t,e,o){"use strict";o.r(e);var a={props:["empresa"],data:function(){return{eventos:"",evento:{idEmpresaEvento:0,evento:{}},eventosdb:[],atual:"",descricao:"",codigo:"",id:"",erro:!1,editar:!1,carregando:!0,mensagem:"Carregando itens cadastrados",html:'<i class="fa fa-spinner fa-spin fa-2x fa-fw"></i>',montou:!1,deletar:"",coluna:"",ordem:!0,termo:"",selecionado:"codigo",idTabela:"#tabelaListagem"}},methods:{carregar:function(t){this.mensagem=t,this.html='<i class="fa fa-spinner fa-spin fa-2x fa-fw"></i>',this.carregando=!0},sucesso:function(t){this.mensagem=t,this.html='<i class="fa fa-check-circle fa-2x fa-fw"></i>';var e=this;setTimeout((function(){e.carregando=!1}),800)},alerta:function(t){this.mensagem=t,this.html='<i class="fa fa-close fa-2x fa-fw"></i>';var e=this;setTimeout((function(){e.carregando=!1}),1e3)},novo:function(){this.evento={idEmpresaEvento:0,evento:{},empresa:this.empresa},this.abrir()},salvar:function(){this.carregar("Salvando novo evento...");var t=this;this.evento?axios.post("/empresas/eventos/empresa/",{evento:t.evento}).then((function(e){"erro"==e.data?t.alerta("Erro ao salvar!"):(t.eventos=e.data,t.$nextTick((function(){t.fechar(),t.sucesso("Salvo com sucesso!")})))})):t.alerta("Preencha todos os campos")},eventoEmEventos:function(t){for(var e=0;e<this.eventos.length;e++)if(this.eventos[e].evento&&this.eventos[e].evento.idEvento===t.idEvento)return!0;return!1},atualizar:function(){var t=this;this.carregar("Atualizando novo evento..."),""!=this.descricao||""!=this.codigo?axios.post("/empresas/eventos/update/"+this.id,{evento:t.evento}).then((function(e){"existente"==e.data?(t.codigo="",t.erro=!0,t.alerta("Código evento já existente, verifique!")):(t.eventos=e.data,t.descricao="",t.codigo="",t.erro=!1,t.$nextTick((function(){t.fechar(),t.sucesso("Atualizado com sucesso!")})))})):t.alerta("Preencha todos os campos")},abrir:function(){$(this.idTabela).DataTable().destroy(),this.$refs.myModal.show()},preencher:function(t){this.carregar("Carregando dados..."),this.evento=Object.assign({},t),this.atual=t.evento.idEvento,this.editar=!0,this.abrir(),this.sucesso("Dados carregados!")},remover:function(t){this.deletar=t.idEmpresaEvento,this.$refs.modalCerteza.show(),$(this.idTabela).DataTable().destroy()},ok:function(t){this.evento.empresa=this.empresa,t.preventDefault(),this.editar,this.salvar()},fechar:function(){this.$root.$emit("montou",[this.idTabela]),this.editar=!1,this.evento={evento:{}},this.$refs.myModal.hide()},fecharCerteza:function(){this.$root.$emit("montou",[this.idTabela]),this.$refs.modalCerteza.hide()},certeza:function(){this.carregar("Removendo evento...");var t=this;axios.get("/empresas/eventos/remover/empresa/"+this.deletar).then((function(e){"erro"!=e.data?axios.get("/empresas/eventos/list/"+t.empresa.idEmpresa).then((function(e){t.eventos=e.data,t.$nextTick((function(){t.fecharCerteza(),t.sucesso("Excluido com sucesso!")}))})):t.$nextTick((function(){t.fecharCerteza(),t.alerta("Erro ao excluir!")}))}))},ordenar:function(t){this.coluna==t?this.ordem=!this.ordem:this.ordem=!0,this.coluna=t,"codigo"==t?1==this.ordem?this.eventos.sort((function(t,e){return t.idEvento>e.idEvento?1:t.idEvento<e.idEvento?-1:0})):this.eventos.sort((function(t,e){return t.idEvento>e.idEvento?-1:t.idEvento<e.idEvento?1:0})):"descricao"==t&&(1==this.ordem?this.eventos.sort((function(t,e){return t.descricao>e.descricao?1:t.descricao<e.descricao?-1:0})):this.eventos.sort((function(t,e){return t.descricao>e.descricao?-1:t.descricao<e.descricao?1:0})))},pesquisar:function(){if(""!=this.termo&&" "!=this.termo){this.carregar("Realizando a busca...");var t=this;axios.get("/empresas/eventos/buscar/"+t.selecionado+"/"+t.termo).then((function(e){e.data.length>0?(t.eventos=e.data,t.sucesso("Encontramos "+e.data.length+" resultado(s)."),t.busca=!0):(t.alerta("Nenhum resultado nesta busca"),t.busca=!1)}))}},voltar:function(){var t=this;this.carregar("Recuperando todos os itens..."),axios.get("/empresas/eventos/list").then((function(e){t.eventos=e.data,t.sucesso("Todas os itens recuperados com sucesso!"),t.busca=!1,t.termo=""}))}},mounted:function(){var t=this;axios.get("/empresas/eventos/list/").then((function(e){t.eventosdb=e.data})),axios.get("/empresas/eventos/list/"+t.empresa.idEmpresa).then((function(e){t.eventos=e.data,t.montou=!0,setTimeout((function(){t.$root.$emit("montou",[t.idTabela]),t.carregando=!1}),200)}))}},s=(o(296),o(164)),n=Object(s.a)(a,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("section",{staticClass:"content"},[t.carregando?o("BlockUI",{attrs:{message:t.mensagem,html:t.html}}):t._e(),t._v(" "),t.montou?o("div",{staticClass:"box box-info"},[o("div",{staticClass:"box-body table-responsive"},[o("table",{staticClass:"table table-hover table-striped",attrs:{id:"tabelaListagem"}},[t._m(0),t._v(" "),o("tbody",t._l(t.eventos,(function(e){return o("tr",[o("td",{staticStyle:{"vertical-align":"middle"},attrs:{width:"80px"}},[o("b",[t._v(t._s(e.idEmpresaEvento))])]),t._v(" "),e.evento?o("td",{staticStyle:{"text-align":"justify"}},[t._v(t._s(e.evento.descricao))]):t._e(),t._v(" "),o("td",[t._v(t._s(e.tipoEvento))]),t._v(" "),o("td",[t._v(t._s(t._f("moment")(e.dataLimite,"DD/MM/Y")))]),t._v(" "),o("td",{staticClass:"text-center",staticStyle:{"vertical-align":"middle"},attrs:{width:"100px"}},[o("button",{staticClass:"btn btn-sm btn-outline-danger",attrs:{type:"button"},on:{click:function(o){return t.remover(e)}}},[o("i",{staticClass:"fa fa-trash"})]),t._v(" "),o("button",{staticClass:"btn btn-sm btn-outline-primary",attrs:{type:"button"},on:{click:function(o){return t.preencher(e)}}},[o("i",{staticClass:"fas fa-pencil-alt"})])])])})),0)])]),t._v(" "),o("div",{staticClass:"box-footer clearfix"},[o("div",{staticClass:"col-md-12 no-padding text-center"},[o("button",{staticClass:"btn btn-success",attrs:{type:"button"},on:{click:function(e){return t.novo()}}},[o("i",{staticClass:"fa fa-plus"}),t._v(" Adicionar")])])])]):t._e(),t._v(" "),o("b-modal",{ref:"myModal",attrs:{size:"xl",centered:"","no-close-on-backdrop":!0,"hide-header-close":!0,"no-close-on-esc":!0,title:"Detalhes do evento","ok-title":"Salvar","cancel-title":"Cancelar",id:"modal1"},on:{ok:t.ok,cancel:function(e){return t.fechar()}}},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-md-2"},[o("div",{staticClass:"form-group",class:{"has-error":t.erro}},[o("label",{attrs:{for:""}},[t._v("Código")]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.evento.idEmpresaEvento,expression:"evento.idEmpresaEvento"}],staticClass:"form-control",attrs:{type:"text",disabled:"",name:"evento"},domProps:{value:t.evento.idEmpresaEvento},on:{input:function(e){e.target.composing||t.$set(t.evento,"idEmpresaEvento",e.target.value)}}})])]),t._v(" "),o("div",{staticClass:"col-md-10"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:""}},[t._v("Evento")]),t._v(" "),o("select",{directives:[{name:"model",rawName:"v-model",value:t.evento.evento,expression:"evento.evento"}],staticClass:"form-control",on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.evento,"evento",e.target.multiple?o:o[0])}}},t._l(t.eventosdb,(function(e){return t.eventoEmEventos(e)&&e.idEvento!==t.atual?t._e():o("option",{domProps:{value:e}},[t._v(t._s(e.idEvento)+" - "+t._s(e.descricao))])})),0)])])]),t._v(" "),o("div",{staticClass:"row"},[o("div",{staticClass:"col-md-3"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:""}},[t._v("Tipo de Evento")]),t._v(" "),o("select",{directives:[{name:"model",rawName:"v-model",value:t.evento.tipoEvento,expression:"evento.tipoEvento"}],staticClass:"form-control",attrs:{name:"",id:""},on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.evento,"tipoEvento",e.target.multiple?o:o[0])}}},[o("option",{attrs:{value:"PCMSO"}},[t._v("PCMSO")]),t._v(" "),o("option",{attrs:{value:"PPRA"}},[t._v("PPRA")]),t._v(" "),o("option",{attrs:{value:"LTCAT"}},[t._v("LTCAT")]),t._v(" "),o("option",{attrs:{value:"OUTROS"}},[t._v("OUTROS")])])])]),t._v(" "),o("div",{staticClass:"col-md-4"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:""}},[t._v("Data Limite")]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.evento.dataLimite,expression:"evento.dataLimite"}],staticClass:"form-control",attrs:{type:"date"},domProps:{value:t.evento.dataLimite},on:{input:function(e){e.target.composing||t.$set(t.evento,"dataLimite",e.target.value)}}})])]),t._v(" "),o("div",{staticClass:"col-md-5"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:""}},[t._v("Observacao")]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.evento.observacao,expression:"evento.observacao"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.evento.observacao},on:{input:function(e){e.target.composing||t.$set(t.evento,"observacao",e.target.value)}}})])])])]),t._v(" "),o("b-modal",{ref:"modalCerteza",attrs:{size:"sm","no-close-on-backdrop":!0,centered:"","hide-header":!0,"hide-footer":!0,"no-close-on-esc":!0,id:"modalCerteza"}},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-md-12 text-center"},[o("h3",[t._v("Tem certeza que deseja excluir este evento?")])])]),t._v(" "),o("div",{staticClass:"row",staticStyle:{"margin-top":"20px"}},[o("div",{staticClass:"col-md-6 text-center"},[o("button",{staticClass:"btn btn-block btn-secondary btn-lg",attrs:{type:"button"},on:{click:t.fecharCerteza}},[o("i",{staticClass:"fa fa-close"}),t._v(" Não")])]),t._v(" "),o("div",{staticClass:"col-md-6 text-center"},[o("button",{staticClass:"btn btn-block btn-danger btn-lg",attrs:{type:"button"},on:{click:t.certeza}},[o("i",{staticClass:"fa fa-check"}),t._v(" Sim")])])])])],1)}),[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("thead",[o("tr",[o("th",[t._v("\n                                Código\n                                \n                                \n                            ")]),t._v(" "),o("th",[t._v("\n                                Descrição\n                                \n                                \n                            ")]),t._v(" "),o("th",[t._v("Tipo")]),t._v(" "),o("th",[t._v("Data Limite")]),t._v(" "),o("th",{staticClass:"text-center no-sort"},[t._v("Ações")])])])}],!1,null,null,null);e.default=n.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{164:function(e,a,t){"use strict";function s(e,a,t,s,i,n,r,o){var c,p="function"==typeof e?e.options:e;if(a&&(p.render=a,p.staticRenderFns=t,p._compiled=!0),s&&(p.functional=!0),n&&(p._scopeId="data-v-"+n),r?(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(r)},p._ssrRegister=c):i&&(c=o?function(){i.call(this,(p.functional?this.parent:this).$root.$options.shadowRoot)}:i),c)if(p.functional){p._injectStyles=c;var d=p.render;p.render=function(e,a){return c.call(a),d(e,a)}}else{var u=p.beforeCreate;p.beforeCreate=u?[].concat(u,c):[c]}return{exports:e,options:p}}t.d(a,"a",(function(){return s}))},53:function(e,a,t){"use strict";t.r(a);var s={props:["empresa"],data:function(){return{epis:[],epi:{},episBanco:[],editar:!1,titulo:"",atual:"",carregando:!0,mensagem:"",cas:[],ca:{},html:'<i class="fa fa-spinner fa-spin fa-2x fa-fw"></i>'}},methods:{testaValidade:function(e){var a=Vue.moment(e,"YYYY-MM-DD"),t=Vue.moment().startOf("day");return Vue.moment.duration(a.diff(t)).asDays()<0?"<span style='color: red'> "+Vue.moment(e).format("DD/MM/YYYY")+"</span>":"<span> "+Vue.moment(e).format("DD/MM/YYYY")+"</span>"},carregar:function(e){this.mensagem=e,this.html='<i class="fa fa-spinner fa-spin fa-2x fa-fw"></i>',this.carregando=!0},preencher:function(e){this.atual=e.epi.idEpi,this.epi=e,this.editar=!0,this.$refs.myModal.show()},abrir:function(){this.epi={},this.$refs.myModal.show()},fechar:function(){this.editar=!1,this.epi={},this.atual="";var e=this;axios.get("/empresas/epis/"+e.empresa.idEmpresa).then((function(a){e.epis=a.data,e.$refs.myModal.hide()}))},fecharCerteza:function(){this.$refs.modalCerteza.hide()},sucesso:function(e){this.mensagem=e,this.html='<i class="fa fa-check-circle fa-2x fa-fw"></i>';var a=this;setTimeout((function(){a.carregando=!1}),800)},epiEmEpi:function(e){for(var a=0;a<this.epis.length;a++)if(this.epis[a].epi.idEpi===e.idEpi)return!0;return!1},ok:function(e){e.preventDefault(),this.editar?this.atualizar():this.salvar()},remover:function(e){this.deletar=e.idEmpresaEpi,this.$refs.modalCerteza.show(),$(this.idTabela).DataTable().destroy()},certeza:function(){this.carregar("Removendo epi...");var e=this;axios.get("/empresas/epis/remover/"+this.empresa.idEmpresa+"/"+this.deletar).then((function(a){e.epis=a.data,e.$nextTick((function(){e.fecharCerteza(),e.sucesso("Excluido com sucesso!")}))}))},atualizar:function(){this.carregar("Atualizando...");var e=this;axios.post("/empresas/epis/atualizar/"+e.empresa.idEmpresa,{dados:e.epi}).then((function(a){e.epis=a.data,e.$nextTick((function(){e.sucesso("EPI atualizado."),e.fechar()}))}))},salvar:function(){this.carregar("Salvando...");var e=this;axios.post("/empresas/epis/novo/"+e.empresa.idEmpresa,{dados:e.epi}).then((function(a){e.epis=a.data,e.$nextTick((function(){e.sucesso("EPI incluído."),e.fechar()}))}))},listCa:function(e){var a=this;this.epi=e,axios.get("/empresas/epis/cas/"+e.idEmpresaEpi).then((function(e){a.cas=e.data})),this.titulo=e.epi.descricao,this.$refs.modalCas.show()},abrirCa:function(){this.$refs.novoCa.show()},okCa:function(){if(console.log(this.epi),this.ca.idEmpresaEpiCa){this.carregar("Atualizando...");var e=this;axios.post("/empresas/epis/cas/atualizar/"+e.ca.idEmpresaEpiCa,{dados:e.ca,empresaEpi:e.epi.idEmpresaEpi}).then((function(a){e.cas=a.data,e.$nextTick((function(){e.sucesso("CA atualizado!"),e.fecharCa()}))}))}else{this.carregar("Salvando...");e=this;axios.post("/empresas/epis/cas/novo/"+e.epi.idEmpresaEpi,{dados:e.ca,empresaEpi:e.epi.idEmpresaEpi}).then((function(a){e.cas=a.data,e.$nextTick((function(){e.sucesso("CA incluído."),e.fecharCa()}))}))}},fecharCa:function(){this.ca={}},preencherCa:function(e){this.ca=e,this.$refs.novoCa.show()},removerCa:function(e){this.carregar("Removendo CA...");var a=this;axios.get("/empresas/epis/cas/remover/"+this.epi.idEmpresaEpi+"/"+e.idEmpresaEpiCa).then((function(e){a.cas=e.data,a.$nextTick((function(){a.sucesso("Excluido com sucesso!")}))}))}},mounted:function(){var e=this;axios.get("/empresas/epis/"+e.empresa.idEmpresa).then((function(a){e.epis=a.data})),axios.get("/tabelas/epi/list/").then((function(a){e.episBanco=a.data})),this.sucesso("Carregados os epis")}},i=t(164),n=Object(i.a)(s,(function(){var e=this.$createElement,a=this._self._c||e;return a("b-card",{staticClass:"sig",attrs:{"no-body":""}},[a("b-tabs",{attrs:{card:""}},[a("b-tab",{attrs:{title:"EPI na Empresa",active:""}},[a("b-card-text")],1),this._v(" "),a("b-tab",{attrs:{title:"Matriz de EPI"}},[a("b-card-text",[a("empresa-ambiente-epi",{attrs:{empresa:this.empresa}})],1)],1)],1)],1)}),[],!1,null,null,null);a.default=n.exports}}]);
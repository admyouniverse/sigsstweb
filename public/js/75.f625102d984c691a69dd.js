(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{0:function(t,e,a){"use strict";function i(t,e,a,i,s,o,n,r){var d,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=a,c._compiled=!0),i&&(c.functional=!0),o&&(c._scopeId="data-v-"+o),n?(d=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(n)},c._ssrRegister=d):s&&(d=r?function(){s.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:s),d)if(c.functional){c._injectStyles=d;var l=c.render;c.render=function(t,e){return d.call(e),l(t,e)}}else{var p=c.beforeCreate;c.beforeCreate=p?[].concat(p,d):[d]}return{exports:t,options:c}}a.d(e,"a",(function(){return i}))},45:function(t,e,a){"use strict";a.r(e);var i={props:["empresa"],data:function(){return{ambientes:[],ambiente:{empresaContratante:{},dataIni:"",dataFim:""},epis:[],epi:{idAmbienteCadastroEpi:0,ambienteTrabalho:{},cadastroEpi:{},validade:0,quantidade:0,uso:""},episAmbiente:[],editar:!1,atual:"",carregando:!0,mensagem:"",html:'<i class="fa fa-spinner fa-spin fa-2x fa-fw"></i>'}},methods:{carregar:function(t){this.mensagem=t,this.html='<i class="fa fa-spinner fa-spin fa-2x fa-fw"></i>',this.carregando=!0},preencher:function(t){var e=this;axios.get("/empresas/ambientes-de-trabalho/epis/"+t.idAmbienteTrabalho).then((function(t){e.episAmbiente=t.data})),this.ambiente=t,this.editar=!0,this.abrir()},edit:function(t){this.epi=Object.assign({},t),this.atual=this.epi.cadastroEpi.idCadastroEpi,this.$refs.novoEpi.show()},adicionarEpi:function(t){this.epi.ambienteTrabalho=t,this.epi.idAmbienteCadastroEpi=0,this.epi.cadastroEpi={},this.epi.validade=0,this.epi.quantidade=0,this.atual={},this.$refs.novoEpi.show()},abrir:function(){this.$refs.myModal.show()},fechar:function(){this.editar=!1,this.ambiente={empresaContratante:{},dataIni:"",dataFim:""},this.atual="",this.$refs.myModal.hide()},fecharCerteza:function(){this.$refs.modalCerteza.hide()},sucesso:function(t){this.mensagem=t,this.html='<i class="fa fa-check-circle fa-2x fa-fw"></i>';var e=this;setTimeout((function(){e.carregando=!1}),800)},epiEmAmbiente:function(t){for(var e=0;e<this.episAmbiente.length;e++)if(this.episAmbiente[e].cadastroEpi.idCadastroEpi===t.idCadastroEpi)return!0;return!1},ok:function(t){t.preventDefault(),this.editar?this.atualizar():this.salvar()},remover:function(t){this.deletar=t,this.$refs.modalCerteza.show(),$(this.idTabela).DataTable().destroy()},certeza:function(){this.carregar("Removendo epi...");var t=this;axios.get("/empresas/ambientes-de-trabalho/remover/epi/"+this.deletar.idAmbienteCadastroEpi).then((function(e){t.preencher(t.deletar.ambienteTrabalho),t.$nextTick((function(){t.fecharCerteza(),t.sucesso("Excluido com sucesso!")}))}))},atualizar:function(){var t=this;axios.post("/empresas/ambientes/atualizar/"+t.empresa.idEmpresa,{ambiente:t.ambiente.idEmpresaContrato,contratante:t.ambiente.empresaContratante.idEmpresa,dataIni:t.ambiente.dataIni,dataFim:t.ambiente.dataFim}).then((function(e){t.ambientes=e.data,t.$nextTick((function(){t.fechar()}))}))},salvarEpi:function(t){t.preventDefault();var e=this;axios.post("/empresas/ambientes-de-trabalho/epi/"+e.empresa.idEmpresa,{epi:e.epi}).then((function(t){e.episAmbiente=t.data,e.$refs.novoEpi.hide()}))}},mounted:function(){var t=this;axios.get("/empresas/epis/"+t.empresa.idEmpresa).then((function(e){t.epis=e.data})),axios.get("/empresas/ambientes-de-trabalho/list/"+t.empresa.inscricao.replace(/[^0-9]/g,"")).then((function(e){t.ambientes=e.data})),this.sucesso("Carregados os ambientes")}},s=a(0),o=Object(s.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"content"},[t.carregando?a("BlockUI",{attrs:{message:t.mensagem,html:t.html}}):t._e(),t._v(" "),a("div",{staticClass:"box box-default"},[a("div",{staticClass:"box-body table-responsive"},[a("table",{staticClass:"table table-hover table-striped",attrs:{id:"tabelaListagem"}},[t._m(0),t._v(" "),a("tbody",t._l(t.ambientes,(function(e){return a("tr",[a("td",[t._v(t._s(e.idAmbienteTrabalho))]),t._v(" "),a("td",[t._v(t._s(e.nomeAmbienteTrabalho))]),t._v(" "),a("td",[a("button",{staticClass:"btn btn-sm btn-outline-danger",attrs:{type:"button"},on:{click:function(a){return t.preencher(e)}}},[t._v("EPI")])])])})),0)])])]),t._v(" "),a("b-modal",{ref:"myModal",attrs:{size:"xl",centered:"",title:"Listagem de EPI","ok-title":"Salvar","cancel-title":"Cancelar","hide-footer":!0,id:"modal1"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("table",{staticClass:"table table-hover table-striped"},[a("tbody",[a("tr",[a("th",[t._v("ID")]),t._v(" "),a("th",[t._v("EPI")]),t._v(" "),a("th",[t._v("Unidade")]),t._v(" "),a("th",[t._v("Quantidade")]),t._v(" "),a("th",[t._v("Validade (Dias)")]),t._v(" "),a("th",[t._v("Uso")]),t._v(" "),a("th",[t._v("Ações")])]),t._v(" "),t._l(t.episAmbiente,(function(e){return a("tr",[a("td",[t._v(t._s(e.idAmbienteCadastroEpi))]),t._v(" "),a("td",[t._v(t._s(e.cadastroEpi.epi.categoriaEpi.grupoEpi.codigoGrupoEpi)+"."+t._s(e.cadastroEpi.epi.categoriaEpi.codigoCategoria)+"\n                                - "+t._s(e.cadastroEpi.epi.codigoNr6)+" | "+t._s(e.cadastroEpi.epi.descricao))]),t._v(" "),a("td",["UN"==e.cadastroEpi.epi.unidade?a("span",[t._v("\n                                    PEÇA\n                                ")]):t._e(),t._v(" "),"UN"!=e.cadastroEpi.epi.unidade?a("span",[t._v("\n                                    "+t._s(e.cadastroEpi.epi.unidade)+"\n                                ")]):t._e()]),t._v(" "),a("td",[t._v(t._s(e.quantidade))]),t._v(" "),a("td",[t._v(t._s(e.validade))]),t._v(" "),a("td",[t._v(t._s(e.uso))]),t._v(" "),a("td",[a("button",{staticClass:"btn btn-sm btn-outline-danger",attrs:{type:"button"},on:{click:function(a){return t.remover(e)}}},[a("i",{staticClass:"fa fa-trash"})]),t._v(" "),a("button",{staticClass:"btn btn-sm btn-outline-primary",attrs:{type:"button"},on:{click:function(a){return t.edit(e)}}},[a("i",{staticClass:"fas fa-pencil-alt"})])])])}))],2)])]),t._v(" "),a("div",{staticClass:"col-md-12 text-center"},[a("button",{staticClass:"btn btn-success btn-lg",on:{click:function(e){return t.adicionarEpi(t.ambiente)}}},[a("i",{staticClass:"fa fa-plus"}),t._v("\n                    Adicionar")])])])]),t._v(" "),a("b-modal",{ref:"novoEpi",attrs:{size:"lg",centered:"","no-close-on-backdrop":!0,"hide-header-close":!0,"no-close-on-esc":!0,title:"Adicionar EPI","ok-title":"Salvar","cancel-title":"Cancelar",id:"modal1"},on:{ok:t.salvarEpi}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("EPI")]),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.epi.cadastroEpi,expression:"epi.cadastroEpi"}],staticClass:"form-control",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.epi,"cadastroEpi",e.target.multiple?a:a[0])}}},t._l(t.epis,(function(e){return t.epiEmAmbiente(e)&&e.idCadastroEpi!==t.atual?t._e():a("option",{domProps:{value:e}},[t._v(t._s(e.epi.categoriaEpi.grupoEpi.codigoGrupoEpi)+"."+t._s(e.epi.categoriaEpi.codigoCategoria)+"\n                            - "+t._s(e.epi.codigoNr6)+" | "+t._s(e.epi.descricao))])})),0)])]),t._v(" "),a("div",{staticClass:"col-md-2"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("ID")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.epi.idAmbienteCadastroEpi,expression:"epi.idAmbienteCadastroEpi"}],staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:t.epi.idAmbienteCadastroEpi},on:{input:function(e){e.target.composing||t.$set(t.epi,"idAmbienteCadastroEpi",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"col-md-2"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("Validade (Dias)")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.epi.validade,expression:"epi.validade"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.epi.validade},on:{input:function(e){e.target.composing||t.$set(t.epi,"validade",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"col-md-2"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("Quantidade")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.epi.quantidade,expression:"epi.quantidade"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.epi.quantidade},on:{input:function(e){e.target.composing||t.$set(t.epi,"quantidade",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("Uso")]),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.epi.uso,expression:"epi.uso"}],staticClass:"form-control",attrs:{id:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.epi,"uso",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"HP"}},[t._v("HP")]),t._v(" "),a("option",{attrs:{value:"HI"}},[t._v("HI")]),t._v(" "),a("option",{attrs:{value:"EV"}},[t._v("EV")])])])]),t._v(" "),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("Unidade")]),t._v(" "),t.epi.cadastroEpi.epi&&"UN"!=t.epi.cadastroEpi.epi.unidade?a("input",{directives:[{name:"model",rawName:"v-model",value:t.epi.cadastroEpi.epi.unidade,expression:"epi.cadastroEpi.epi.unidade"}],staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:t.epi.cadastroEpi.epi.unidade},on:{input:function(e){e.target.composing||t.$set(t.epi.cadastroEpi.epi,"unidade",e.target.value)}}}):t._e(),t._v(" "),t.epi.cadastroEpi.epi&&"UN"==t.epi.cadastroEpi.epi.unidade?a("input",{staticClass:"form-control",attrs:{type:"text",disabled:"",value:"PEÇA"}}):t._e(),t._v(" "),t.epi.cadastroEpi.epi?t._e():a("input",{staticClass:"form-control",attrs:{type:"text",disabled:""}})])])])]),t._v(" "),a("b-modal",{ref:"modalCerteza",attrs:{size:"sm","no-close-on-backdrop":!0,centered:"","hide-header":!0,"hide-footer":!0,"no-close-on-esc":!0,id:"modalCerteza"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12 text-center"},[a("h3",[t._v("Tem certeza que deseja excluir este EPI?")])])]),t._v(" "),a("div",{staticClass:"row",staticStyle:{"margin-top":"20px"}},[a("div",{staticClass:"col-md-6 text-center"},[a("button",{staticClass:"btn btn-block btn-secondary btn-lg",attrs:{type:"button"},on:{click:t.fecharCerteza}},[a("i",{staticClass:"fa fa-close"}),t._v(" Não")])]),t._v(" "),a("div",{staticClass:"col-md-6 text-center"},[a("button",{staticClass:"btn btn-block btn-danger btn-lg",attrs:{type:"button"},on:{click:t.certeza}},[a("i",{staticClass:"fa fa-check"}),t._v(" Sim")])])])])],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("ID")]),this._v(" "),e("th",[this._v("Ambiente Trabalho")]),this._v(" "),e("th",[this._v("Ações")])])])}],!1,null,null,null);e.default=o.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{164:function(a,t,e){"use strict";function c(a,t,e,c,i,o,s,r){var n,p="function"==typeof a?a.options:a;if(t&&(p.render=t,p.staticRenderFns=e,p._compiled=!0),c&&(p.functional=!0),o&&(p._scopeId="data-v-"+o),s?(n=function(a){(a=a||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(a=__VUE_SSR_CONTEXT__),i&&i.call(this,a),a&&a._registeredComponents&&a._registeredComponents.add(s)},p._ssrRegister=n):i&&(n=r?function(){i.call(this,(p.functional?this.parent:this).$root.$options.shadowRoot)}:i),n)if(p.functional){p._injectStyles=n;var l=p.render;p.render=function(a,t){return n.call(t),l(a,t)}}else{var d=p.beforeCreate;p.beforeCreate=d?[].concat(d,n):[n]}return{exports:a,options:p}}e.d(t,"a",(function(){return c}))},46:function(a,t,e){"use strict";e.r(t);var c={props:["empresa"],data:function(){return{ambientes:[],ambiente:{empresaContratante:{},dataIni:"",dataFim:""},capacitacoes:[],capacitacao:{idAmbienteEmpresaCapacitacao:0,ambienteTrabalho:{},empresaCapacitacao:{capacitacao:{}},periodicidade:0,observacao:0},capacitacoesAmbiente:[],editar:!1,atual:"",carregando:!0,mensagem:"",html:'<i class="fa fa-spinner fa-spin fa-2x fa-fw"></i>'}},methods:{carregar:function(a){this.mensagem=a,this.html='<i class="fa fa-spinner fa-spin fa-2x fa-fw"></i>',this.carregando=!0},preencher:function(a){this.ambiente=a;var t=this;axios.get("/empresas/ambientes-de-trabalho/capacitacoes/"+a.idAmbienteTrabalho).then((function(a){t.capacitacoesAmbiente=a.data})),this.editar=!0,this.abrir()},edit:function(a){this.capacitacao=Object.assign({},a),this.atual=this.capacitacao.empresaCapacitacao.idEmpresaCapacitacao,this.$refs.novoEpi.show()},adicionarEpi:function(a){this.capacitacao.ambienteTrabalho=a,this.$refs.novoEpi.show()},abrir:function(){this.$refs.myModal.show()},fechar:function(){this.editar=!1,this.ambiente={empresaContratante:{},dataIni:"",dataFim:""},this.atual="",this.$refs.myModal.hide()},fecharCerteza:function(){this.$refs.modalCerteza.hide()},sucesso:function(a){this.mensagem=a,this.html='<i class="fa fa-check-circle fa-2x fa-fw"></i>';var t=this;setTimeout((function(){t.carregando=!1}),800)},capacitacaoEmCapacitacoes:function(a){for(var t=0;t<this.capacitacoesAmbiente.length;t++)if(this.capacitacoesAmbiente[t].empresaCapacitacao.idEmpresaCapacitacao===a.idEmpresaCapacitacao)return!0;return!1},ok:function(a){a.preventDefault(),this.editar?this.atualizar():this.salvar()},remover:function(a){this.deletar=a,this.$refs.modalCerteza.show(),$(this.idTabela).DataTable().destroy()},certeza:function(){this.carregar("Removendo capacitacao...");var a=this;axios.get("/empresas/ambientes-de-trabalho/remover/capacitacao/"+this.deletar.idAmbienteEmpresaEpi).then((function(t){a.preencher(a.deletar.ambienteTrabalho),a.$nextTick((function(){a.fecharCerteza(),a.sucesso("Excluido com sucesso!")}))}))},atualizar:function(){var a=this;axios.post("/empresas/ambientes/atualizar/"+a.empresa.idEmpresa,{ambiente:a.ambiente.idEmpresaContrato,contratante:a.ambiente.empresaContratante.idEmpresa,dataIni:a.ambiente.dataIni,dataFim:a.ambiente.dataFim}).then((function(t){a.ambientes=t.data,a.$nextTick((function(){a.fechar()}))}))},salvarEpi:function(a){a.preventDefault();var t=this;axios.post("/empresas/ambientes-de-trabalho/capacitacao/"+t.empresa.idEmpresa,{capacitacao:t.capacitacao}).then((function(a){t.capacitacoesAmbiente=a.data,t.$refs.novoEpi.hide()}))}},mounted:function(){var a=this;axios.get("/capacitacao/"+a.empresa.idEmpresa).then((function(t){a.capacitacoes=t.data})),axios.get("/empresas/ambientes-de-trabalho/list/"+a.empresa.inscricao.replace(/[^0-9]/g,"")).then((function(t){a.ambientes=t.data})),this.sucesso("Carregados os ambientes")}},i=e(164),o=Object(i.a)(c,(function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"row"},[a.carregando?e("BlockUI",{attrs:{message:a.mensagem,html:a.html}}):a._e(),a._v(" "),e("div",{staticClass:"col-md-12"},[e("div",{staticClass:"box box-default"},[e("div",{staticClass:"box-body table-responsive"},[e("table",{staticClass:"table table-hover table-striped",attrs:{id:"tabelaListagem"}},[a._m(0),a._v(" "),e("tbody",a._l(a.ambientes,(function(t){return e("tr",[e("td",[a._v(a._s(t.idAmbienteTrabalho))]),a._v(" "),e("td",[a._v(a._s(t.nomeAmbienteTrabalho))]),a._v(" "),e("td",[e("button",{staticClass:"btn btn-sm btn-outline-danger",attrs:{type:"button"},on:{click:function(e){return a.preencher(t)}}},[a._v("Capacitação")])])])})),0)])])])]),a._v(" "),e("b-modal",{ref:"myModal",attrs:{size:"xl",centered:"",title:"Listagem de Capacitacao","ok-title":"Salvar","cancel-title":"Cancelar","hide-footer":!0,id:"modal1"}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12"},[e("table",{staticClass:"table table-hover table-striped"},[e("tbody",[e("tr",[e("th",[a._v("ID")]),a._v(" "),e("th",[a._v("Capacitação")]),a._v(" "),e("th",[a._v("Periodicidade")]),a._v(" "),e("th",[a._v("Observação")]),a._v(" "),e("th",[a._v("Ações")])]),a._v(" "),a._l(a.capacitacoesAmbiente,(function(t){return e("tr",[e("td",[a._v(a._s(t.idAmbienteEmpresaCapacitacao))]),a._v(" "),e("td",[a._v(a._s(t.empresaCapacitacao.capacitacao.descricao))]),a._v(" "),e("td",[a._v(a._s(t.periodicidade))]),a._v(" "),e("td",[a._v(a._s(t.observacao))]),a._v(" "),e("td",[e("button",{staticClass:"btn btn-sm btn-outline-danger",attrs:{type:"button"},on:{click:function(e){return a.remover(t)}}},[e("i",{staticClass:"fa fa-trash"})]),a._v(" "),e("button",{staticClass:"btn btn-sm btn-outline-primary",attrs:{type:"button"},on:{click:function(e){return a.edit(t)}}},[e("i",{staticClass:"fas fa-pencil-alt"})])])])}))],2)])]),a._v(" "),e("div",{staticClass:"col-md-12 text-center"},[e("button",{staticClass:"btn btn-success btn-lg",on:{click:function(t){return a.adicionarEpi(a.ambiente)}}},[e("i",{staticClass:"fa fa-plus"}),a._v("\n                    Adicionar")])])])]),a._v(" "),e("b-modal",{ref:"novoEpi",attrs:{size:"xl",centered:"","no-close-on-backdrop":!0,"hide-header-close":!0,"no-close-on-esc":!0,title:"Detalhes da Capacitação","ok-title":"Salvar","cancel-title":"Cancelar",id:"modal1"},on:{ok:a.salvarEpi}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-2"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[a._v("ID")]),a._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:a.capacitacao.idAmbienteEmpresaCapacitacao,expression:"capacitacao.idAmbienteEmpresaCapacitacao"}],staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:a.capacitacao.idAmbienteEmpresaCapacitacao},on:{input:function(t){t.target.composing||a.$set(a.capacitacao,"idAmbienteEmpresaCapacitacao",t.target.value)}}})])]),a._v(" "),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[a._v("Descricao")]),a._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:a.capacitacao.empresaCapacitacao,expression:"capacitacao.empresaCapacitacao"}],staticClass:"form-control",on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){return"_value"in a?a._value:a.value}));a.$set(a.capacitacao,"empresaCapacitacao",t.target.multiple?e:e[0])}}},a._l(a.capacitacoes,(function(t){return a.capacitacaoEmCapacitacoes(t)&&t.idEmpresaCapacitacao!==a.atual?a._e():e("option",{domProps:{value:t}},[a._v(" "+a._s(t.capacitacao.descricao))])})),0)])]),a._v(" "),e("div",{staticClass:"col-md-3"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[a._v("Tabela 29")]),a._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:a.capacitacao.empresaCapacitacao.capacitacao.tabela29,expression:"capacitacao.empresaCapacitacao.capacitacao.tabela29"}],staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:a.capacitacao.empresaCapacitacao.capacitacao.tabela29},on:{input:function(t){t.target.composing||a.$set(a.capacitacao.empresaCapacitacao.capacitacao,"tabela29",t.target.value)}}})])]),a._v(" "),e("div",{staticClass:"col-md-3"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[a._v("Tipo")]),a._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:a.capacitacao.empresaCapacitacao.capacitacao.tipo,expression:"capacitacao.empresaCapacitacao.capacitacao.tipo"}],staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:a.capacitacao.empresaCapacitacao.capacitacao.tipo},on:{input:function(t){t.target.composing||a.$set(a.capacitacao.empresaCapacitacao.capacitacao,"tipo",t.target.value)}}})])])]),a._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[a._v("Grupo de Capacitacao")]),a._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:a.capacitacao.empresaCapacitacao.capacitacao.grupoCapacitacao,expression:"capacitacao.empresaCapacitacao.capacitacao.grupoCapacitacao"}],staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:a.capacitacao.empresaCapacitacao.capacitacao.grupoCapacitacao},on:{input:function(t){t.target.composing||a.$set(a.capacitacao.empresaCapacitacao.capacitacao,"grupoCapacitacao",t.target.value)}}})])]),a._v(" "),e("div",{staticClass:"col"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[a._v("Capacitação Pai")]),a._v(" "),a.capacitacao.empresaCapacitacao.capacitacao.capacitacaoPai?e("input",{directives:[{name:"model",rawName:"v-model",value:a.capacitacao.empresaCapacitacao.capacitacao.capacitacaoPai.descricao,expression:"capacitacao.empresaCapacitacao.capacitacao.capacitacaoPai.descricao"}],staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:a.capacitacao.empresaCapacitacao.capacitacao.capacitacaoPai.descricao},on:{input:function(t){t.target.composing||a.$set(a.capacitacao.empresaCapacitacao.capacitacao.capacitacaoPai,"descricao",t.target.value)}}}):a._e(),a._v(" "),a.capacitacao.empresaCapacitacao.capacitacao.capacitacaoPai?a._e():e("input",{staticClass:"form-control",attrs:{type:"text",disabled:""}})])]),a._v(" "),e("div",{staticClass:"col"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[a._v("Carga Horária")]),a._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:a.capacitacao.empresaCapacitacao.cargaHr,expression:"capacitacao.empresaCapacitacao.cargaHr"}],staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:a.capacitacao.empresaCapacitacao.cargaHr},on:{input:function(t){t.target.composing||a.$set(a.capacitacao.empresaCapacitacao,"cargaHr",t.target.value)}}})])]),a._v(" "),e("div",{staticClass:"col"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[a._v("Tipo")]),a._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:a.capacitacao.empresaCapacitacao.tipo,expression:"capacitacao.empresaCapacitacao.tipo"}],staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:a.capacitacao.empresaCapacitacao.tipo},on:{input:function(t){t.target.composing||a.$set(a.capacitacao.empresaCapacitacao,"tipo",t.target.value)}}})])]),a._v(" "),"EVENTUAL"!=a.capacitacao.empresaCapacitacao.tipo&&"INICIAL"!=a.capacitacao.empresaCapacitacao.tipo?e("div",{staticClass:"col"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[a._v("Periodicidade")]),a._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:a.capacitacao.periodicidade,expression:"capacitacao.periodicidade"}],staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:a.capacitacao.periodicidade},on:{input:function(t){t.target.composing||a.$set(a.capacitacao,"periodicidade",t.target.value)}}})])]):a._e()]),a._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[a._v("Observação")]),a._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:a.capacitacao.observacao,expression:"capacitacao.observacao"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:a.capacitacao.observacao},on:{input:function(t){t.target.composing||a.$set(a.capacitacao,"observacao",t.target.value)}}})])])])]),a._v(" "),e("b-modal",{ref:"modalCerteza",attrs:{size:"sm","no-close-on-backdrop":!0,centered:"","hide-header":!0,"hide-footer":!0,"no-close-on-esc":!0,id:"modalCerteza"}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12 text-center"},[e("h3",[a._v("Tem certeza que deseja excluir este EPI?")])])]),a._v(" "),e("div",{staticClass:"row",staticStyle:{"margin-top":"20px"}},[e("div",{staticClass:"col-md-6 text-center"},[e("button",{staticClass:"btn btn-block btn-secondary btn-lg",attrs:{type:"button"},on:{click:a.fecharCerteza}},[e("i",{staticClass:"fa fa-close"}),a._v(" Não")])]),a._v(" "),e("div",{staticClass:"col-md-6 text-center"},[e("button",{staticClass:"btn btn-block btn-danger btn-lg",attrs:{type:"button"},on:{click:a.certeza}},[e("i",{staticClass:"fa fa-check"}),a._v(" Sim")])])])])],1)}),[function(){var a=this.$createElement,t=this._self._c||a;return t("thead",[t("tr",[t("th",[this._v("ID")]),this._v(" "),t("th",[this._v("Ambiente Trabalho")]),this._v(" "),t("th",[this._v("Ações")])])])}],!1,null,null,null);t.default=o.exports}}]);